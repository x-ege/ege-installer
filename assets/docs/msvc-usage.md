# Visual Studio EGE 项目使用指南

## 📚 关于本指南

本指南介绍如何在 Visual Studio 中创建和使用 EGE 图形库项目。

> **提示**：如果您还未安装 EGE，请先使用安装程序将 EGE 安装到 Visual Studio。

> **✨ 优势**：Visual Studio 使用 EGE 无需手动配置链接器选项，自动链接所需库文件！

---

## 📝 创建新的 EGE 项目

### 创建控制台应用程序

**Visual Studio 2019/2022/2026:**

1. 打开 Visual Studio
2. 在启动窗口点击 **创建新项目**（或菜单：**文件 → 新建 → 项目...**）
3. 搜索并选择 **空项目** 或 **控制台应用**
4. 输入项目名称和保存位置
5. 点击 **创建**

**Visual Studio 2017 及更早版本:**

1. 打开 Visual Studio
2. 点击菜单：**文件 → 新建 → 项目...**
3. 选择 **Visual C++ → Win32 → Win32 控制台应用程序**
4. 输入项目名称，点击 **确定**
5. 在向导中选择 **空项目**，点击 **完成**

### 添加源文件

1. 在 **解决方案资源管理器** 中，右键点击 **源文件** 文件夹
2. 选择 **添加 → 新建项...**
3. 选择 **C++ 文件(.cpp)**，输入文件名（如 `main.cpp`）
4. 点击 **添加**

---

## 🚀 快速开始示例

在 `main.cpp` 中输入以下代码：

```cpp
#include <graphics.h>

int main()
{
    // 初始化图形窗口 (640x480)
    initgraph(640, 480, 0);
    
    // 设置窗口标题
    setcaption("EGE Graphics - Hello World");
    
    // 设置背景色为白色
    setbkcolor(WHITE);
    cleardevice();
    
    // 绘制一个蓝色填充圆
    setfillcolor(BLUE);
    fillellipse(320, 200, 100, 100);
    
    // 设置文字颜色并输出
    setcolor(BLACK);
    setfont(24, 0, "微软雅黑");
    outtextxy(220, 350, "Hello, EGE Graphics!");
    
    // 等待用户按键
    getch();
    
    // 关闭图形窗口
    closegraph();
    
    return 0;
}
```

按 **F5（调试运行）** 或 **Ctrl+F5（不调试运行）** 即可运行程序！

> **提示**：推荐使用 **Ctrl+F5（不调试运行）**，可以避免调试器的干扰。

---

## ⚙️ 项目配置说明

### 无需手动配置链接器

✨ **好消息**：Visual Studio 项目使用 EGE 时，**无需手动添加任何链接器选项**！

EGE 库使用了 Visual Studio 的 **自动链接** 特性（通过 `#pragma comment(lib, ...)` 实现），编译时会自动链接所需的库文件。

### 字符集设置（可选）

如果需要使用宽字符函数（如 `outtextxy` 输出中文），建议设置项目字符集：

1. 在 **解决方案资源管理器** 中，右键点击项目名称
2. 选择 **属性**
3. 导航到 **配置属性 → 高级**
4. 将 **字符集** 设置为 **使用多字节字符集** 或 **使用 Unicode 字符集**
5. 点击 **确定** 保存

### 平台架构选择

EGE 同时支持 **x86（32位）** 和 **x64（64位）** 编译：

- 在工具栏的 **解决方案平台** 下拉列表中可以切换
- 默认选择 **x86** 或 **x64** 均可正常使用

---

## 📚 更多资源

- **官方网站**: <https://xege.org/>
- **示例教程**: <https://xege.org/man/tutorial/>
- **GitHub**: <https://github.com/wysaid/xege>

---

## 🔧 故障排除

### 编译时提示找不到 graphics.h

**原因**：EGE 未正确安装到 Visual Studio。

**解决方案**：

1. 重新运行 EGE 安装程序
2. 确保选择了正确的 Visual Studio 版本
3. 安装完成后重启 Visual Studio

### 链接时出现 LNK2019 未解析的外部符号

**原因**：项目平台架构与库文件不匹配。

**解决方案**：

1. 检查当前项目的平台架构（工具栏中的 **解决方案平台**）
2. 确保 EGE 已正确安装到对应架构
3. 如果问题仍然存在，尝试：
   - 清理解决方案（**生成 → 清理解决方案**）
   - 重新生成（**生成 → 重新生成解决方案**）

### 程序运行时闪退

**可能原因**：

1. **未调用 `getch()` 等待输入**：在 `closegraph()` 前添加 `getch()` 即可
2. **使用 F5 调试运行**：尝试使用 **Ctrl+F5（不调试运行）** 代替

### 中文显示乱码

**解决方案**：

1. 确保源文件使用 **UTF-8 with BOM** 编码保存
2. 在代码开头添加：

   ```cpp
   #pragma execution_character_set("utf-8")
   ```

3. 或者在项目属性中设置字符集（参见上方 [字符集设置](#字符集设置可选)）

### Visual Studio 版本不支持

**支持的版本**：

- ✅ Visual Studio 2017 - 2026（所有版本）

**不支持的版本**：

- ❌ Visual Studio 2010 - 2015
- ❌ Visual Studio 6.0 - 2008

如果您使用的是不支持的版本，建议：

1. 升级到 Visual Studio 2022 Community（免费）
2. 或使用其他支持的 IDE（如 Code::Blocks、Red Panda C++ 等）

---

## ❓ 常见问题

### Q: Visual Studio 需要手动配置链接器吗？

**A**: 不需要！EGE 使用 Visual Studio 的自动链接特性，无需手动配置任何链接器选项。

### Q: EGE 支持哪些 Visual Studio 版本？

**A**: 支持 VS 2017-2026。不支持 VS 2015 及更早的版本。

### Q: x86 和 x64 编译有什么区别？

**A**: 两者都可以正常使用 EGE。x64 编译的程序可以使用更多内存，但文件体积略大。日常使用建议选择 x86。

### Q: 可以在 Visual Studio Code 中使用 EGE 吗？

**A**: 可以，但 VS Code 需要配置 MSVC 工具链或 MinGW 编译器。如果使用 MinGW，请参考 MinGW 或 CLion 的使用说明。

### Q: 如何卸载 EGE？

**A**: 运行安装程序，点击对应 Visual Studio 版本的"卸载"按钮即可。

---

## 💡 使用提示

- **推荐使用 Ctrl+F5 运行**：避免调试器干扰，且不会闪退
- **创建空项目最简单**：无需删除模板生成的多余代码
- **无需配置链接器**：Visual Studio 会自动链接 EGE 库
- **支持 x86 和 x64**：两种架构都可以正常使用
- **官方文档有更多示例**：<https://xege.org/man/tutorial/>
- **遇到问题先清理重新生成**：可解决大部分编译链接问题

祝您使用愉快！🎨
