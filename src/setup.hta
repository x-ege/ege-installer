<!DOCTYPE html>
<html>

<head>
  <title>EGE å›¾å½¢åº“å®‰è£…ç¨‹åº</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta charset="UTF-8">
  <HTA:APPLICATION ID="EGEInstaller" APPLICATIONNAME="EGE Installer" BORDER="thin" BORDERSTYLE="normal" CAPTION="yes"
    ICON="../assets/ege-icon.ico" MAXIMIZEBUTTON="no" MINIMIZEBUTTON="yes" NAVIGABLE="no" SCROLL="no" SELECTION="no"
    SHOWINTASKBAR="yes" SINGLEINSTANCE="yes" SYSMENU="yes" VERSION="1.0" WINDOWSTATE="normal" />
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: "Microsoft YaHei", "Segoe UI", sans-serif;
    }

    /* rem åŸºå‡†å€¼ï¼š14px = 1remï¼Œç”± ui.js æ ¹æ®å±å¹•åˆ†è¾¨ç‡åŠ¨æ€è°ƒæ•´ */
    html {
      font-size: 14px;
    }

    html,
    body {
      width: 100%;
      height: 100%;
      overflow: hidden;
    }

    body {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }

    .container {
      background: white;
      width: 100%;
      height: 100%;
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    .header {
      background: linear-gradient(135deg, #4a5568 0%, #2d3748 100%);
      color: white;
      padding: 1.143rem 2.143rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .header-left h1 {
      font-size: 1.571rem;
      font-weight: 600;
    }

    .header-left p {
      font-size: 0.929rem;
      opacity: 0.85;
      margin-top: 0.143rem;
    }

    .header-right {
      text-align: right;
      display: flex;
      align-items: center;
      gap: 0.571rem;
    }

    .version-badge {
      background: rgba(255, 255, 255, 0.2);
      padding: 0.286rem 0.857rem;
      border-radius: 0.857rem;
      font-size: 0.857rem;
    }

    .content {
      flex: 1;
      padding: 1.429rem 2.143rem;
      overflow: auto;
      display: flex;
      flex-direction: column;
    }

    .intro {
      background: #f0f9ff;
      border-left: 0.286rem solid #3b82f6;
      padding: 0.857rem 1.143rem;
      margin-bottom: 1.143rem;
      border-radius: 0 0.429rem 0.429rem 0;
    }

    .intro p {
      font-size: 1rem;
      color: #1e40af;
      line-height: 1.5;
    }

    .section-title {
      font-size: 1.071rem;
      color: #374151;
      margin-bottom: 0.857rem;
      font-weight: 500;
    }

    .ide-list {
      flex: 1;
      border: 1px solid #e5e7eb;
      border-radius: 0.571rem;
      overflow-y: auto;
    }

    .ide-item {
      display: flex;
      align-items: center;
      padding: 0.857rem 1.143rem;
      border-bottom: 1px solid #e5e7eb;
    }

    .ide-item:last-child {
      border-bottom: none;
    }

    .ide-item:hover {
      background: #f9fafb;
    }

    .ide-info {
      flex: 1;
    }

    .ide-name {
      font-size: 1rem;
      font-weight: 500;
      color: #1f2937;
    }

    .ide-path {
      font-size: 0.857rem;
      color: #6b7280;
      margin-top: 0.143rem;
    }

    .ide-status {
      margin: 0 0.857rem;
      padding: 0.214rem 0.714rem;
      border-radius: 0.286rem;
      font-size: 0.857rem;
      min-width: 5rem;
      text-align: center;
    }

    .ide-status.installed {
      background: #dcfce7;
      color: #166534;
    }

    .ide-status.not-installed {
      background: #fef9c3;
      color: #854d0e;
    }

    .ide-status.not-found {
      background: #f3f4f6;
      color: #9ca3af;
    }

    .btn-status-guide {
      background: #dcfce7;
      color: #166534;
      border: 1px solid #86efac;
      padding: 0.214rem 0.714rem;
      border-radius: 0.286rem;
      font-size: 0.857rem;
      cursor: pointer;
      min-width: 5rem;
      text-align: center;
      margin: 0 0.857rem;
      font-weight: 500;
      transition: all 0.15s;
    }

    .btn-status-guide:hover {
      background: #bbf7d0;
      border-color: #4ade80;
    }

    .ide-actions {
      display: flex;
      gap: 0.571rem;
    }

    .btn {
      padding: 0.429rem 1.143rem;
      border: none;
      border-radius: 0.286rem;
      font-size: 0.929rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.15s;
      min-width: 4.571rem;
    }

    .btn-install {
      background: #3b82f6;
      color: white;
    }

    .btn-install:hover {
      background: #2563eb;
    }

    .btn-uninstall {
      background: #ef4444;
      color: white;
    }

    .btn-uninstall:hover {
      background: #dc2626;
    }

    .btn-guide {
      background: #f59e0b;
      color: white;
      min-width: 5.714rem;
    }

    .btn-guide:hover {
      background: #d97706;
    }

    .btn-open {
      background: #6b7280;
      color: white;
    }

    .btn-open:hover {
      background: #4b5563;
    }

    .btn-site {
      background: #6b8676;
      color: white;
      min-width: 4rem;
      padding: 0.429rem 0.857rem;
    }

    .btn-site:hover {
      background: #4b6b5e;
    }

    .btn:disabled {
      background: #e5e7eb;
      color: #9ca3af;
      cursor: not-allowed;
    }

    /* Code::Blocks æ— ç¼–è¯‘å™¨è­¦å‘Šå›¾æ ‡ */
    .cb-warning-icon {
      display: inline-flex;
      align-items: center;
      margin-left: 0.571rem;
      padding: 0.143rem 0.571rem;
      background: #fef3c7;
      border: 1px solid #fbbf24;
      border-radius: 0.286rem;
      font-size: 0.857rem;
      color: #92400e;
      cursor: help;
      transition: all 0.15s;
    }

    .cb-warning-icon:hover {
      background: #fde68a;
      border-color: #f59e0b;
    }

    .cb-warning-icon::before {
      content: "âš ";
      margin-right: 0.286rem;
      font-size: 1rem;
    }

    .footer {
      padding: 0.857rem 2.143rem;
      border-top: 1px solid #e5e7eb;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #f9fafb;
    }

    .footer-left {
      font-size: 0.857rem;
      color: #6b7280;
    }

    .footer-right {
      display: flex;
      gap: 0.714rem;
    }

    .btn-scan {
      padding: 0.571rem 1.429rem;
      background: #10b981;
      color: white;
      border: none;
      border-radius: 0.286rem;
      font-size: 0.929rem;
      cursor: pointer;
    }

    .btn-scan:hover {
      background: #059669;
    }

    .btn-close {
      padding: 0.571rem 1.714rem;
      background: #6b7280;
      color: white;
      border: none;
      border-radius: 0.286rem;
      font-size: 1rem;
      cursor: pointer;
    }

    .btn-close:hover {
      background: #4b5563;
    }

    .toggle-section {
      margin-top: 1.143rem;
      padding-top: 0.857rem;
      border-top: 1px dashed #e5e7eb;
    }

    .toggle-btn {
      background: none;
      border: none;
      color: #6b7280;
      font-size: 0.929rem;
      cursor: pointer;
      padding: 0.286rem 0;
    }

    .toggle-btn:hover {
      color: #374151;
    }

    .hidden-section {
      display: none;
    }

    .hidden-section.show {
      display: block;
    }

    .loading {
      text-align: center;
      padding: 2.857rem;
      color: #6b7280;
    }

    .loading-spinner {
      width: 2.857rem;
      height: 2.857rem;
      border: 0.214rem solid #e5e7eb;
      border-top-color: #3b82f6;
      border-radius: 50%;
      margin: 0 auto 1.143rem;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    .detection-log {
      background: #f9fafb;
      border: 1px solid #e5e7eb;
      border-radius: 0.429rem;
      padding: 0.857rem;
      margin-top: 0.857rem;
      max-height: 10.714rem;
      overflow-y: auto;
      font-size: 0.857rem;
      color: #6b7280;
      font-family: 'Consolas', monospace;
    }

    .detection-log .log-line {
      padding: 0.143rem 0;
    }

    .detection-log .log-line.info {
      color: #3b82f6;
    }

    .detection-log .log-line.success {
      color: #10b981;
    }

    .detection-log .log-line.error {
      color: #ef4444;
    }

    .detection-progress {
      height: 0.286rem;
      background: #e5e7eb;
      border-radius: 0.143rem;
      margin: 0.857rem 0;
      overflow: hidden;
    }

    .detection-progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #3b82f6, #8b5cf6);
      width: 0%;
      transition: width 0.3s ease;
    }

    /* Modal overlay */
    .modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }

    .modal-overlay.show {
      display: flex;
    }

    .modal {
      background: white;
      border-radius: 0.571rem;
      width: 35.714rem;
      max-height: 80vh;
      overflow: hidden;
      box-shadow: 0 1.786rem 3.571rem rgba(0, 0, 0, 0.25);
      display: flex;
      flex-direction: column;
    }

    .modal-header {
      padding: 1.143rem 1.429rem;
      background: #f9fafb;
      border-bottom: 1px solid #e5e7eb;
      font-size: 1.143rem;
      font-weight: 500;
      color: #1f2937;
      flex-shrink: 0;
    }

    .modal-body {
      padding: 1.429rem;
      overflow-y: auto;
      flex: 1 1 auto;
      min-height: 0;
      max-height: calc(80vh - 8.571rem);
    }

    .modal-footer {
      padding: 0.857rem 1.429rem;
      border-top: 1px solid #e5e7eb;
      text-align: right;
      flex-shrink: 0;
    }

    .log-area {
      background: #1f2937;
      color: #d1d5db;
      padding: 0.857rem;
      border-radius: 0.429rem;
      font-family: "Consolas", monospace;
      font-size: 0.857rem;
      max-height: 14.286rem;
      overflow-y: auto;
    }

    .log-area .success {
      color: #4ade80;
    }

    .log-area .error {
      color: #f87171;
    }

    .log-area .info {
      color: #60a5fa;
    }

    .progress-bar {
      height: 0.571rem;
      background: #e5e7eb;
      border-radius: 0.286rem;
      margin-bottom: 0.857rem;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #3b82f6, #8b5cf6);
      width: 0%;
      transition: width 0.3s;
    }

    .empty-message {
      text-align: center;
      padding: 2.857rem 1.429rem;
      color: #6b7280;
    }

    .empty-message p {
      margin-bottom: 0.571rem;
    }

    /* Large Guide Modal - è¯¦ç»†ä½¿ç”¨æŒ‡å—é€šç”¨æ ·å¼ï¼ˆé€‚ç”¨äº CodeBlocks/Dev-C++/MSVC ç­‰ï¼‰*/
    .large-guide-modal {
      width: 57.143rem;
      max-width: 90%;
      max-height: 90vh;
      animation: slideIn 0.3s ease-out;
      display: flex;
      flex-direction: column;
    }

    @keyframes slideIn {
      from {
        transform: translateY(-2.143rem);
        opacity: 0;
      }

      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    .large-guide-modal .modal-header {
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      color: white;
      padding: 1.429rem 1.714rem;
      font-size: 1.429rem;
      font-weight: 600;
    }

    .large-guide-modal .modal-body {
      padding: 1.714rem;
      overflow-y: auto;
      line-height: 1.6;
      flex: 1 1 auto;
      min-height: 0;
      max-height: calc(90vh - 10.714rem);
    }

    .guide-section {
      margin-bottom: 1.429rem;
    }

    .guide-section .section-icon {
      font-size: 1.714rem;
      margin-right: 0.571rem;
    }

    .guide-section h3 {
      font-size: 1.143rem;
      color: #1f2937;
      margin-bottom: 0.857rem;
      font-weight: 600;
    }

    .guide-section p {
      color: #4b5563;
      margin-bottom: 0.571rem;
      font-size: 1rem;
    }

    .guide-steps {
      background: #f9fafb;
      border-left: 0.214rem solid #10b981;
      padding: 1.143rem;
      border-radius: 0.429rem;
      margin: 0.857rem 0;
    }

    .guide-steps ol {
      margin: 0;
      padding-left: 1.714rem;
    }

    .guide-steps li {
      color: #374151;
      margin-bottom: 0.571rem;
      font-size: 1rem;
    }

    .guide-tips {
      background: #fef3c7;
      border-left: 0.214rem solid #f59e0b;
      padding: 0.857rem 1.143rem;
      border-radius: 0.429rem;
      margin: 0.857rem 0;
    }

    .guide-tips ul {
      margin: 0.571rem 0 0 0;
      padding-left: 1.714rem;
    }

    .guide-tips li {
      color: #78350f;
      margin-bottom: 0.429rem;
      font-size: 0.929rem;
    }

    .guide-link {
      color: #3b82f6;
      text-decoration: none;
      font-weight: 500;
    }

    .guide-link:hover {
      text-decoration: underline;
    }

    .large-guide-modal .modal-footer {
      padding: 1.143rem 1.714rem;
      text-align: center;
      flex-shrink: 0;
    }

    .btn-got-it {
      padding: 0.714rem 2.286rem;
      background: #10b981;
      color: white;
      border: none;
      border-radius: 0.429rem;
      font-size: 1.071rem;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.2s;
    }

    .btn-got-it:hover {
      background: #059669;
    }

    /* Unsupported VS Guide Modal */
    .unsupported-vs-guide-modal {
      width: 42.857rem;
      max-height: 85vh;
      animation: slideIn 0.3s ease-out;
      display: flex;
      flex-direction: column;
    }

    .unsupported-vs-guide-modal .modal-header {
      background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
      color: white;
      padding: 1.429rem 1.714rem;
      font-size: 1.357rem;
      font-weight: 600;
    }

    .unsupported-vs-guide-modal .modal-body {
      padding: 1.714rem;
      overflow-y: auto;
      line-height: 1.6;
      flex: 1 1 auto;
      min-height: 0;
      max-height: calc(85vh - 10rem);
    }

    .warning-box {
      background: #fef3c7;
      border-left: 0.286rem solid #f59e0b;
      padding: 1.143rem;
      border-radius: 0.429rem;
      margin: 1.143rem 0;
    }

    .warning-box h3 {
      color: #92400e;
      font-size: 1.143rem;
      margin-bottom: 0.857rem;
      font-weight: 600;
    }

    .warning-box p {
      color: #78350f;
      font-size: 1rem;
      margin-bottom: 0.571rem;
      line-height: 1.6;
    }

    .info-box {
      background: #f0f9ff;
      border-left: 0.286rem solid #3b82f6;
      padding: 1.143rem;
      border-radius: 0.429rem;
      margin: 1.143rem 0;
    }

    .info-box h3 {
      color: #1e40af;
      font-size: 1.143rem;
      margin-bottom: 0.857rem;
      font-weight: 600;
    }

    .info-box p {
      color: #1e40af;
      font-size: 1rem;
      margin-bottom: 0.571rem;
      line-height: 1.6;
    }

    .btn-visit-site {
      padding: 0.857rem 2rem;
      background: #3b82f6;
      color: white;
      border: none;
      border-radius: 0.429rem;
      font-size: 1.071rem;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.2s;
      margin-right: 0.857rem;
    }

    .btn-visit-site:hover {
      background: #2563eb;
    }

    .btn-cancel {
      padding: 0.857rem 2rem;
      background: #6b7280;
      color: white;
      border: none;
      border-radius: 0.429rem;
      font-size: 1.071rem;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.2s;
    }

    .btn-cancel:hover {
      background: #4b5563;
    }

    /* Install Guide Modal */
    .install-guide-modal {
      width: 40rem;
      max-height: 85vh;
      animation: slideIn 0.3s ease-out;
      display: flex;
      flex-direction: column;
    }

    .install-guide-modal .modal-header {
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      color: white;
      padding: 1.286rem 1.714rem;
      font-size: 1.286rem;
      font-weight: 600;
    }

    .install-guide-modal .modal-body {
      padding: 1.714rem;
      line-height: 1.6;
      flex: 1 1 auto;
      min-height: 0;
      overflow-y: auto;
      max-height: calc(85vh - 9.286rem);
    }

    .install-guide-modal .modal-body p {
      font-size: 1rem;
      color: #374151;
      margin-bottom: 0.857rem;
    }

    .guide-command-wrapper {
      display: flex;
      gap: 0.571rem;
      align-items: flex-start;
      margin: 0.857rem 0;
    }

    .guide-command-box {
      background: #1f2937;
      color: #e5e7eb;
      padding: 0.857rem 1.143rem;
      border-radius: 0.429rem;
      font-family: "Consolas", monospace;
      font-size: 0.929rem;
      line-height: 1.8;
      flex: 1;
      word-break: break-all;
      cursor: text;
    }

    .btn-copy {
      padding: 0.429rem 1rem;
      background: rgba(255, 255, 255, 0.15);
      color: #d1d5db;
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 0.286rem;
      font-size: 0.857rem;
      cursor: pointer;
      white-space: nowrap;
      flex-shrink: 0;
      transition: all 0.2s;
    }

    .btn-copy:hover {
      background: rgba(255, 255, 255, 0.25);
    }

    .btn-copy.copied {
      background: #059669;
      color: white;
      border-color: #059669;
    }

    /* é€šç”¨æŒ‡å—æ¨¡æ€çª—å£æ ·å¼ */
    .guide-modal-common {
      width: 50rem;
      max-width: 90%;
      max-height: 90vh;
      animation: slideIn 0.3s ease-out;
      display: flex;
      flex-direction: column;
    }

    .guide-modal-common .modal-header {
      color: white;
      padding: 1.429rem 1.714rem;
      font-size: 1.429rem;
      font-weight: 600;
    }

    .guide-modal-common .modal-body {
      padding: 1.714rem;
      overflow-y: auto;
      line-height: 1.6;
      flex: 1 1 auto;
      min-height: 0;
      max-height: calc(90vh - 10.714rem);
    }

    .guide-modal-common .modal-footer {
      padding: 1.143rem 1.714rem;
      text-align: center;
      flex-shrink: 0;
    }

    /* CLion æ’ä»¶æ¨èæ¨¡æ€çª—å£ */
    .clion-plugin-modal .modal-header {
      background: linear-gradient(135deg, #7c3aed 0%, #4f46e5 100%);
    }

    .clion-plugin-modal .modal-footer {
      display: flex;
      justify-content: center;
      gap: 0.857rem;
    }

    .btn-clion-plugin {
      padding: 0.714rem 1.714rem;
      background: #7c3aed;
      color: white;
      border: none;
      border-radius: 0.429rem;
      font-size: 1rem;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.2s;
    }

    .btn-clion-plugin:hover {
      background: #6d28d9;
    }

    .btn-clion-continue {
      padding: 0.714rem 1.714rem;
      background: #6b7280;
      color: white;
      border: none;
      border-radius: 0.429rem;
      font-size: 1rem;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.2s;
    }

    .btn-clion-continue:hover {
      background: #4b5563;
    }

    /* Red Panda ä½¿ç”¨è¯´æ˜æ¨¡æ€çª—å£ */
    .redpanda-guide-modal .modal-header {
      background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <div class="header-left">
        <h1 id="appTitle">EGE å›¾å½¢åº“å®‰è£…ç¨‹åº</h1>
        <p>Easy Graphics Engine - ç®€æ˜“å›¾å½¢å¼•æ“</p>
      </div>
      <div class="header-right">
        <div style="font-size: 1.429rem; color: rgba(255, 255, 255, 0.8); margin-right: 0.857rem;">
          ğŸ’¡ æŒ‰ Ctrl+é¼ æ ‡æ»šè½® è°ƒæ•´æ–‡å­—å¤§å°
        </div>
        <span id="versionBadge" class="version-badge">v1.0.0</span>
      </div>
    </div>

    <div class="content">
      <div class="intro">
        <p>æ³¨æ„: å®‰è£…åˆ° MinGW ä¹‹å, ä»éœ€é…ç½®ç¼–è¯‘é€‰é¡¹ä»¥æ­£ç¡®ä½¿ç”¨ EGE åº“, <a href="javascript:void(0)"
            onclick="openUrl('https://xege.org/install_and_config'); return false;">ç‚¹å‡»æŸ¥çœ‹è¯´æ˜</a></p>
        <p>åœ¨ä¸‹é¢æ‰¾åˆ°æ‚¨æ‰€ç”¨çš„å¼€å‘å¹³å°ï¼Œç‚¹å‡»ã€Œå®‰è£…ã€å°† EGE åº“å®‰è£…è‡³è¯¥å¹³å°ï¼Œæˆ–ç‚¹å‡»ã€Œå¸è½½ã€ä»è¯¥å¹³å°ç§»é™¤ã€‚</p>
      </div>

      <p class="section-title">æ£€æµ‹åˆ°çš„å¼€å‘ç¯å¢ƒï¼š</p>
      <div id="ideList" class="ide-list">
        <div class="loading">
          <div class="loading-spinner"></div>
          <p id="detectionStatus">æ­£åœ¨æ£€æµ‹å·²å®‰è£…çš„ IDE...</p>
          <div class="detection-progress">
            <div id="detectionProgressBar" class="detection-progress-bar"></div>
          </div>
          <div id="detectionLog" class="detection-log"></div>
        </div>
      </div>

      <div id="notFoundSection" class="toggle-section hidden-section">
        <button class="toggle-btn" onclick="toggleNotFound()">â–¶ æ˜¾ç¤ºæœªæ£€æµ‹åˆ°çš„ç¯å¢ƒ</button>
        <div id="notFoundList" class="ide-list" style="margin-top: 0.857rem; display: none;"></div>
      </div>
    </div>

    <div class="footer">
      <div class="footer-left">
        <span id="statusText">å°±ç»ª</span>
      </div>
      <div class="footer-right">
        <button class="btn-scan" onclick="scanForMinGW()">æ‰«ææ›´å¤š</button>
        <button class="btn-close" onclick="refreshPage()">åˆ·æ–°</button>
      </div>
    </div>
  </div>

  <!-- Operation Modal -->
  <div id="operationModal" class="modal-overlay" onclick="handleModalOverlayClick(event, 'operationModal')">
    <div class="modal">
      <div class="modal-header" id="modalTitle">æ­£åœ¨å®‰è£…...</div>
      <div class="modal-body">
        <div class="progress-bar">
          <div id="modalProgress" class="progress-fill"></div>
        </div>
        <div id="modalLog" class="log-area"></div>
      </div>
      <div class="modal-footer">
        <button id="modalGuideBtn" class="btn btn-install" onclick="openGuideFromModal()"
          style="display:none; margin-right: 0.571rem;">æŸ¥çœ‹ä½¿ç”¨è¯´æ˜</button>
        <button id="modalCloseBtn" class="btn btn-install" onclick="closeModal()" disabled>å®Œæˆ</button>
      </div>
    </div>
  </div>

  <!-- CodeBlocks ä½¿ç”¨è¯´æ˜æ¨¡æ€çª—å£ -->
  <div id="codeBlocksGuideModal" class="modal-overlay" onclick="handleModalOverlayClick(event, 'codeBlocksGuideModal')">
    <div class="modal large-guide-modal">
      <div class="modal-header">
        <span class="section-icon">ğŸ“š</span>
        Code::Blocks EGE ä½¿ç”¨æŒ‡å—
      </div>
      <div class="modal-body">
        <div class="guide-section">
          <p style="font-size: 1.071rem; color: #1f2937; font-weight: 500; margin-bottom: 1.143rem;">
            æœ¬æŒ‡å—ä»‹ç»å¦‚ä½•åœ¨ Code::Blocks ä¸­åˆ›å»ºå’Œä½¿ç”¨ EGE å›¾å½¢åº“é¡¹ç›®ã€‚
          </p>
          <p style="font-size: 0.929rem; color: #6b7280; margin-bottom: 1.143rem;">
            ğŸ’¡ <strong>æç¤ºï¼š</strong>å¦‚æœæ‚¨è¿˜æœªå®‰è£… EGEï¼Œè¯·å…ˆä½¿ç”¨å®‰è£…ç¨‹åºå°† EGE å®‰è£…åˆ° Code::Blocksã€‚
          </p>
        </div>

        <div class="guide-section">
          <h3><span class="section-icon">ğŸ“</span>åˆ›å»º EGE é¡¹ç›®</h3>

          <p style="font-size: 0.929rem; color: #6b7280; margin-bottom: 0.571rem;"><strong>æ–¹æ³•ä¸€ï¼šé¡¹ç›®å‘å¯¼ï¼ˆæ¨èï¼ŒCode::Blocks
              25.03+ï¼‰</strong></p>
          <p style="font-size: 0.929rem; margin-left: 1.429rem; color: #374151;">
            æ–‡ä»¶ â†’ æ–°å»º â†’ é¡¹ç›®... â†’ <strong>2D/3D Graphics</strong> â†’ <strong>EGE project</strong>
          </p>

          <div style="margin: 0.857rem 0; text-align: center;">
            <img src="../assets/docs/images/codeblocks_new_proj.png"
              style="max-width: 100%; height: auto; border: 1px solid #e5e7eb; border-radius: 0.429rem; box-shadow: 0 0.143rem 0.286rem rgba(0,0,0,0.1);"
              alt="Code::Blocks é¡¹ç›®å‘å¯¼" />
          </div>

          <p style="font-size: 0.929rem; color: #6b7280; margin: 0.857rem 0 0.571rem 0;"><strong>æ–¹æ³•äºŒï¼šç”¨æˆ·æ¨¡æ¿</strong></p>
          <p style="font-size: 0.929rem; margin-left: 1.429rem; color: #374151;">
            æ–‡ä»¶ â†’ ä»ç”¨æˆ·æ¨¡æ¿æ–°å»º... â†’ é€‰æ‹© <strong>EGE_Project</strong>
          </p>

          <div style="margin: 0.857rem 0; text-align: center;">
            <img src="../assets/docs/images/codeblocks_user_template.png"
              style="max-width: 100%; height: auto; border: 1px solid #e5e7eb; border-radius: 0.429rem; box-shadow: 0 0.143rem 0.286rem rgba(0,0,0,0.1);"
              alt="Code::Blocks ç”¨æˆ·æ¨¡æ¿" />
          </div>
        </div>

        <div class="guide-section">
          <div class="guide-tips">
            <h3 style="margin: 0 0 0.571rem 0; font-size: 1.071rem; color: #92400e;">ğŸ’¡ å¿«é€Ÿæç¤º</h3>
            <ul>
              <li>æ¨¡æ¿å·²é…ç½®æ‰€æœ‰é€‰é¡¹ï¼Œ<strong>æ— éœ€æ‰‹åŠ¨è®¾ç½®</strong></li>
              <li>ç›´æ¥ä½¿ç”¨ <code>#include &lt;graphics.h&gt;</code></li>
              <li>æŒ‰ <strong>F9</strong> ç¼–è¯‘è¿è¡Œ</li>
              <li>è‹¥æ¨¡æ¿æœªæ˜¾ç¤ºï¼Œè¯·é‡å¯ Code::Blocks</li>
            </ul>
          </div>
        </div>

        <div class="guide-section"
          style="background: #f0f9ff; border-left: 0.214rem solid #3b82f6; padding: 0.857rem; margin-top: 1.143rem;">
          <p style="margin: 0; font-size: 0.929rem; color: #1e40af;">
            <span style="font-weight: 600;">ğŸ“– éœ€è¦è¯¦ç»†è¯´æ˜ï¼Ÿ</span><br>
            åŒ…å«ç¼–è¯‘å™¨é…ç½®ã€æ‰‹åŠ¨é…ç½®æ–¹æ³•ã€ä»£ç ç¤ºä¾‹ã€å¸¸è§é—®é¢˜ç­‰å®Œæ•´æŒ‡å—
          </p>
          <button class="btn-view-docs" onclick="openCodeBlocksFullDocs()"
            style="margin-top: 0.571rem; padding: 0.429rem 0.857rem; background: #3b82f6; color: white; border: none; border-radius: 0.286rem; cursor: pointer; font-size: 0.857rem;">
            æŸ¥çœ‹å®Œæ•´ä½¿ç”¨æ–‡æ¡£
          </button>
        </div>

        <div class="guide-section">
          <h3><span class="section-icon">ğŸ“š</span>æ›´å¤šèµ„æº</h3>
          <p>
            <a href="javascript:void(0)" class="guide-link"
              onclick="openUrl('https://xege.org/'); return false;">å®˜æ–¹ç½‘ç«™</a> Â·
            <a href="javascript:void(0)" class="guide-link"
              onclick="openUrl('https://github.com/wysaid/xege'); return false;">GitHub æºç </a>
          </p>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-got-it" onclick="closeCodeBlocksGuide()">çŸ¥é“äº†ï¼Œå¼€å§‹ä½¿ç”¨ EGEï¼</button>
      </div>
    </div>
  </div>

  <!-- Dev-C++ ä½¿ç”¨è¯´æ˜æ¨¡æ€çª—å£ -->
  <div id="devCppGuideModal" class="modal-overlay" onclick="handleModalOverlayClick(event, 'devCppGuideModal')">
    <div class="modal large-guide-modal">
      <div class="modal-header">
        <span class="section-icon">ğŸ“š</span>
        Dev-C++ EGE ä½¿ç”¨æŒ‡å—
      </div>
      <div class="modal-body">
        <div class="guide-section">
          <p style="font-size: 1.071rem; color: #1f2937; font-weight: 500; margin-bottom: 1.143rem;">
            æœ¬æŒ‡å—ä»‹ç»å¦‚ä½•åœ¨ Dev-C++ ä¸­åˆ›å»ºå’Œä½¿ç”¨ EGE å›¾å½¢åº“é¡¹ç›®ã€‚
          </p>
          <p style="font-size: 0.929rem; color: #6b7280; margin-bottom: 1.143rem;">
            ğŸ’¡ <strong>æç¤ºï¼š</strong>å¦‚æœæ‚¨è¿˜æœªå®‰è£… EGEï¼Œè¯·å…ˆä½¿ç”¨å®‰è£…ç¨‹åºå°† EGE å®‰è£…åˆ° Dev-C++ã€‚<br>
            âš ï¸ <strong>é‡è¦ï¼š</strong>æ­¤æ¨¡æ¿ä»…æ”¯æŒ 64-bit ç¼–è¯‘ï¼Œè¯·ç¡®ä¿ç¼–è¯‘å™¨æ¶æ„è®¾ç½®ä¸º x86_64ã€‚
          </p>
        </div>

        <div class="guide-section">
          <h3><span class="section-icon">ğŸ“</span>åˆ›å»º EGE é¡¹ç›®</h3>

          <p style="font-size: 0.929rem; color: #6b7280; margin-bottom: 0.571rem;"><strong>æ–¹æ³•ä¸€ï¼šé¡¹ç›®æ¨¡æ¿ï¼ˆæ¨èï¼‰</strong></p>
          <p style="font-size: 0.929rem; margin-left: 1.429rem; color: #374151;">
            æ–‡ä»¶ â†’ æ–°å»º â†’ é¡¹ç›®... â†’ <strong>Multimedia</strong> â†’ <strong>EGE Graphics</strong>
          </p>

          <div style="margin: 0.857rem 0; text-align: center;">
            <img src="../assets/docs/images/devcpp_new_proj.png"
              style="max-width: 100%; height: auto; border: 1px solid #e5e7eb; border-radius: 0.429rem; box-shadow: 0 0.143rem 0.286rem rgba(0,0,0,0.1);"
              alt="Dev-C++ é¡¹ç›®æ¨¡æ¿" />
          </div>

          <p style="font-size: 0.929rem; color: #6b7280; margin: 0.857rem 0 0.571rem 0;"><strong>æ–¹æ³•äºŒï¼šæ‰‹åŠ¨é…ç½®</strong></p>
          <p style="font-size: 0.929rem; margin-left: 1.429rem; color: #374151;">
            é¡¹ç›®å±æ€§ â†’ å‚æ•° â†’ é“¾æ¥å™¨ï¼Œæ·»åŠ åº“é€‰é¡¹ï¼ˆè¯¦è§å®Œæ•´æ–‡æ¡£ï¼‰
          </p>
        </div>

        <div class="guide-section">
          <div class="guide-tips">
            <h3 style="margin: 0 0 0.571rem 0; font-size: 1.071rem; color: #92400e;">ğŸ’¡ å¿«é€Ÿæç¤º</h3>
            <ul>
              <li><strong>âš ï¸ ä»…æ”¯æŒ 64-bit ç¼–è¯‘ï¼</strong>ç¡®ä¿æ¶æ„è®¾ç½®ä¸º <code>x86_64</code></li>
              <li>æ¨¡æ¿å·²é…ç½®æ‰€æœ‰é€‰é¡¹ï¼Œ<strong>æ— éœ€æ‰‹åŠ¨è®¾ç½®</strong></li>
              <li>ç›´æ¥ä½¿ç”¨ <code>#include &lt;graphics.h&gt;</code></li>
              <li>æŒ‰ <strong>F11</strong> ç¼–è¯‘è¿è¡Œ</li>
              <li>è‹¥æ¨¡æ¿æœªæ˜¾ç¤ºï¼Œè¯·é‡å¯ Dev-C++</li>
            </ul>

            <div style="margin: 0.857rem 0 0 0; text-align: center;">
              <img src="../assets/docs/images/devcpp_choose_64bit.png"
                style="max-width: 100%; height: auto; border: 1px solid #e5e7eb; border-radius: 0.429rem; box-shadow: 0 0.143rem 0.286rem rgba(0,0,0,0.1);"
                alt="Dev-C++ 64-bit æ¶æ„è®¾ç½®" />
              <p style="font-size: 0.857rem; color: #6b7280; margin-top: 0.429rem;">ç¡®ä¿ç¼–è¯‘å™¨æ¶æ„ä¸º x86_64</p>
            </div>
          </div>
        </div>

        <div class="guide-section"
          style="background: #f0f9ff; border-left: 0.214rem solid #3b82f6; padding: 0.857rem; margin-top: 1.143rem;">
          <p style="margin: 0; font-size: 0.929rem; color: #1e40af;">
            <span style="font-weight: 600;">ğŸ“– éœ€è¦è¯¦ç»†è¯´æ˜ï¼Ÿ</span><br>
            åŒ…å«ç¼–è¯‘å™¨æ¶æ„é…ç½®ã€æ‰‹åŠ¨é…ç½®æ­¥éª¤ã€ä»£ç ç¤ºä¾‹ã€å¸¸è§é—®é¢˜ç­‰å®Œæ•´æŒ‡å—
          </p>
          <button class="btn-view-docs" onclick="openDevCppFullDocs()"
            style="margin-top: 0.571rem; padding: 0.429rem 0.857rem; background: #3b82f6; color: white; border: none; border-radius: 0.286rem; cursor: pointer; font-size: 0.857rem;">
            æŸ¥çœ‹å®Œæ•´ä½¿ç”¨æ–‡æ¡£
          </button>
        </div>

        <div class="guide-section">
          <h3><span class="section-icon">ğŸ“š</span>æ›´å¤šèµ„æº</h3>
          <p>
            <a href="javascript:void(0)" class="guide-link"
              onclick="openUrl('https://xege.org/'); return false;">å®˜æ–¹ç½‘ç«™</a> Â·
            <a href="javascript:void(0)" class="guide-link"
              onclick="openUrl('https://github.com/wysaid/xege'); return false;">GitHub æºç </a>
          </p>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-got-it" onclick="closeDevCppGuide()">çŸ¥é“äº†ï¼Œå¼€å§‹ä½¿ç”¨ EGEï¼</button>
      </div>
    </div>
  </div>

  <!-- ä¸æ”¯æŒçš„ VS ç‰ˆæœ¬å®‰è£…è¯´æ˜æ¨¡æ€çª—å£ -->
  <div id="unsupportedVSGuideModal" class="modal-overlay"
    onclick="handleModalOverlayClick(event, 'unsupportedVSGuideModal')">

    <div class="modal unsupported-vs-guide-modal">
      <div class="modal-header">
        <span class="section-icon">âš ï¸</span>
        ä¸æ”¯æŒçš„ Visual Studio ç‰ˆæœ¬
      </div>
      <div class="modal-body">
        <div class="warning-box">
          <h3>å½“å‰ç‰ˆæœ¬è¯´æ˜</h3>
          <p>
            æ‚¨æ£€æµ‹åˆ°çš„ <strong>Visual Studio 2010 / 2012 / 2013 / 2015</strong> ç›®å‰ä¸è¢«æœ¬å®‰è£…ç¨‹åºç›´æ¥æ”¯æŒã€‚
          </p>
          <p>
            è¿™äº›ç‰ˆæœ¬å·²ç»éå¸¸è€æ—§ï¼Œä¸”å¾®è½¯å·²åœæ­¢å¯¹å…¶çš„å®˜æ–¹æ”¯æŒã€‚æœ¬å®‰è£…ç¨‹åºä¸åŒ…å«é’ˆå¯¹è¿™äº›ç‰ˆæœ¬çš„åº“æ–‡ä»¶ã€‚
          </p>
        </div>

        <div class="info-box">
          <h3>ğŸ“¦ è·å–å®Œæ•´ç¦»çº¿å®‰è£…åŒ…</h3>
          <p>
            å¦‚æœæ‚¨éœ€è¦åœ¨è¿™äº›ç‰ˆæœ¬çš„ Visual Studio ä¸­ä½¿ç”¨ EGE å›¾å½¢åº“ï¼Œè¯·è®¿é—® EGE å®˜æ–¹ç½‘ç«™ä¸‹è½½æ›´å®Œæ•´çš„ç¦»çº¿å®‰è£…åŒ…ã€‚
          </p>
          <p style="margin-top: 0.857rem;">
            <strong>å®˜æ–¹å®‰è£…æŒ‡å—ï¼š</strong><br>
            <a href="javascript:void(0)" class="guide-link"
              onclick="openUrl('https://xege.org/install_and_config'); return false;">https://xege.org/install_and_config</a>
          </p>
        </div>

        <div class="info-box">
          <h3>ğŸ’¡ å»ºè®®</h3>
          <p>
            å¦‚æœå¯èƒ½ï¼Œæˆ‘ä»¬å»ºè®®å‡çº§åˆ° <strong>Visual Studio 2017</strong> æˆ–æ›´æ–°ç‰ˆæœ¬ï¼ˆå¦‚ VS 2022ï¼‰ï¼Œè¿™äº›ç‰ˆæœ¬è·å¾—æ›´å¥½çš„æ”¯æŒå’Œæ›´æ–°ã€‚
          </p>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-visit-site" onclick="openEgeInstallPage()">è®¿é—®å®˜ç½‘</button>
        <button class="btn-cancel" onclick="closeUnsupportedVSGuide()">å…³é—­</button>
      </div>
    </div>
  </div>

  <script language="JScript">
    // ========== æ—¥å¿—ç³»ç»Ÿï¼ˆç”¨äºè°ƒè¯• Windows 7 å…¼å®¹æ€§é—®é¢˜ï¼‰==========
    var logFilePath = "";
    var debugMode = false;
    var cachedFso = null;

    function writeLog(message) {
      try {
        // åˆå§‹åŒ–é…ç½®ï¼ˆé¦–æ¬¡è°ƒç”¨ï¼‰
        if (!logFilePath) {
          if (!cachedFso) {
            cachedFso = new ActiveXObject("Scripting.FileSystemObject");
          }
          var tempShell = new ActiveXObject("WScript.Shell");
          var tempDir = tempShell.ExpandEnvironmentStrings("%TEMP%");
          logFilePath = tempDir + "\\ege_installer_log.txt";

          // æ£€æŸ¥ debug mode æ ‡å¿—
          var debugFlag = tempDir + "\\.ege-debug";
          debugMode = cachedFso.FileExists(debugFlag);
        }

        // é debug æ¨¡å¼ä¸‹åªè®°å½•é”™è¯¯
        if (!debugMode && message.indexOf("ERROR") !== 0) {
          return;
        }

        if (!cachedFso) {
          cachedFso = new ActiveXObject("Scripting.FileSystemObject");
        }
        var file = cachedFso.OpenTextFile(logFilePath, 8, true);
        file.WriteLine("[" + new Date().toLocaleTimeString() + "] " + message);
        file.Close();
      } catch (e) {
        // é™é»˜å¤±è´¥
      }
    }

    // åˆå§‹åŒ–æ—¥å¿—ï¼ˆæ¸…ç©ºæ—§æ—¥å¿—æ–‡ä»¶ï¼‰
    try {
      cachedFso = new ActiveXObject("Scripting.FileSystemObject");
      var tempShell = new ActiveXObject("WScript.Shell");
      var tempDir = tempShell.ExpandEnvironmentStrings("%TEMP%");
      logFilePath = tempDir + "\\ege_installer_log.txt";

      // æ£€æŸ¥ debug mode æ ‡å¿—
      var debugFlag = tempDir + "\\.ege-debug";
      debugMode = cachedFso.FileExists(debugFlag);

      // æ¸…ç©ºæ—§æ—¥å¿—
      if (cachedFso.FileExists(logFilePath)) {
        cachedFso.DeleteFile(logFilePath);
      }

      // å†™å…¥å¯åŠ¨æ—¥å¿—
      if (debugMode) {
        var file = cachedFso.OpenTextFile(logFilePath, 8, true);
        file.WriteLine("[" + new Date().toLocaleTimeString() + "] EGE Installer Started - " + navigator.userAgent);
        file.WriteLine("[" + new Date().toLocaleTimeString() + "] Debug mode ENABLED");
        file.Close();
      }
    } catch (e) { }

    // å…¨å±€é”™è¯¯å¤„ç†
    window.onerror = function (msg, url, line) {
      writeLog("ERROR: " + msg + " at line " + line);
      alert('è„šæœ¬é”™è¯¯:\n' + msg + '\nè¡Œå·: ' + line + '\n\næ—¥å¿—å·²ä¿å­˜åˆ°:\n' + logFilePath);
      return true;
    };

    // åŸºç¡€å˜é‡
    var fso, shell, currentPath, libsPath, egeVersion;
    var detectedIDEs = [];
    var notFoundIDEs = [];
    var notFoundExpanded = false;
    var dryRunMode = false;  // Dry-run æ¨¡å¼æ ‡å¿—

    // åˆå§‹åŒ–
    try {
      fso = new ActiveXObject("Scripting.FileSystemObject");
      shell = new ActiveXObject("WScript.Shell");

      var htaPath = document.location.pathname;
      if (htaPath.charAt(0) === '/') {
        htaPath = htaPath.substr(1);
      }
      htaPath = htaPath.replace(/\//g, '\\');
      currentPath = fso.GetParentFolderName(htaPath);
      writeLog("å½“å‰ç›®å½•: " + currentPath);

      // æ£€æµ‹ EGE åº“è·¯å¾„ï¼šæ”¯æŒæ‰“åŒ…ç¯å¢ƒå’Œå¼€å‘ç¯å¢ƒ
      // æ‰“åŒ…ç¯å¢ƒï¼š<project_root>/libs
      writeLog("æ£€æµ‹ EGE åº“è·¯å¾„...");
      // å¼€å‘ç¯å¢ƒï¼š<parent_of_project>/xege_libs
      var projectRoot = fso.GetParentFolderName(currentPath);
      var devLibsPath = projectRoot + '\\libs';

      if (fso.FolderExists(devLibsPath)) {
        // æ‰“åŒ…åçš„è·¯å¾„
        libsPath = devLibsPath;
        writeLog("æ‰¾åˆ°æ‰“åŒ…è·¯å¾„: " + libsPath);
      } else {
        // å¼€å‘ç¯å¢ƒï¼šå°è¯•åœ¨é¡¹ç›®çˆ¶ç›®å½•æŸ¥æ‰¾ xege_libs
        var grandParentDir = fso.GetParentFolderName(projectRoot);
        var xegeLibsPath = grandParentDir + '\\xege_libs';
        if (fso.FolderExists(xegeLibsPath)) {
          libsPath = xegeLibsPath;
        } else {
          // ä¹Ÿå°è¯• xege-libsï¼ˆå¸¦è¿å­—ç¬¦ï¼‰
          var xegeLibsPath2 = grandParentDir + '\\xege-libs';
          if (fso.FolderExists(xegeLibsPath2)) {
            libsPath = xegeLibsPath2;
          } else {
            writeLog("æœªæ‰¾åˆ°åº“è·¯å¾„ï¼Œå°†ç”± installer.js æ¢æµ‹");
            // ç•™ç©ºï¼Œè®© installer.js è‡ªè¡Œæ¢æµ‹
            libsPath = '';
          }
        }
      }

      // æ£€æµ‹ dry-run æ¨¡å¼ï¼ˆå¼€å‘è°ƒè¯•ç”¨ï¼‰
      // æ ‡å¿—æ–‡ä»¶ä½ç½®ï¼šé¡¹ç›®æ ¹ç›®å½•/temp/.dry-run
      var dryRunFlagFile = projectRoot + '\\temp\\.dry-run';
      if (fso.FileExists(dryRunFlagFile)) {
        dryRunMode = true;
      }

      writeLog("è¯»å–ç‰ˆæœ¬å·...");
      // è¯»å–ç‰ˆæœ¬å·ï¼ˆä» version.txt è¯»å– EGE åº“ç‰ˆæœ¬ï¼‰
      // ä¼˜å…ˆå°è¯•æ‰“åŒ…åçš„ä½ç½®ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™å°è¯•å¼€å‘ç¯å¢ƒä½ç½®
      var versionFile = projectRoot + '\\version.txt';

      // å¦‚æœæ‰“åŒ…ä½ç½®ä¸å­˜åœ¨ï¼Œå°è¯•å¼€å‘ç¯å¢ƒä½ç½®
      if (!fso.FileExists(versionFile)) {
        var parentDir = fso.GetParentFolderName(projectRoot);
        versionFile = parentDir + '\\xege_libs\\version.txt';
      }

      if (fso.FileExists(versionFile)) {
        var ts = fso.OpenTextFile(versionFile, 1);
        var content = ts.ReadAll();
        ts.Close();
        // ç§»é™¤å¯èƒ½çš„BOMå­—ç¬¦ (\uFEFF æˆ– \xEF\xBB\xBF)
        if (content.charCodeAt(0) === 0xFEFF || content.charCodeAt(0) === 0xEF) {
          content = content.substring(1);
        }
        // æå–ç‰ˆæœ¬å·ï¼šæ”¯æŒä¸¤ç§æ ¼å¼ "Version: x.x.x" æˆ–çº¯ç‰ˆæœ¬å· "x.x.x"
        var match = content.match(/(?:Version:\s*)?([0-9]+[0-9.\-a-zA-Z]*)/i);
        // IE7/8 å…¼å®¹ï¼šä½¿ç”¨ replace ä»£æ›¿ trim()
        egeVersion = match ? match[1].replace(/^\s+|\s+$/g, '') : '';
      } else {
        egeVersion = '1.0.0';
      }
      if (!egeVersion || egeVersion.length === 0) {
        egeVersion = '1.0.0';
      }

      // æ›´æ–°æ ‡é¢˜å’Œç‰ˆæœ¬æ˜¾ç¤º
      document.getElementById('appTitle').innerText = 'EGE å›¾å½¢åº“å®‰è£…ç¨‹åº';
      document.getElementById('versionBadge').innerText = 'v' + egeVersion;
      document.title = 'EGE å›¾å½¢åº“å®‰è£…ç¨‹åº v' + egeVersion;

      // å¦‚æœæ˜¯ dry-run æ¨¡å¼ï¼Œæ›´æ–° UI æç¤º
      if (dryRunMode) {
        document.getElementById('appTitle').innerText = 'EGE å›¾å½¢åº“å®‰è£…ç¨‹åº [DRY-RUN æ¨¡å¼]';
        document.getElementById('versionBadge').innerText = 'v' + egeVersion + ' (DRY-RUN)';
        document.getElementById('versionBadge').style.background = '#f59e0b';
        document.title = 'EGE å›¾å½¢åº“å®‰è£…ç¨‹åº v' + egeVersion + ' [DRY-RUN]';
        // è®¾ç½® Installer çš„ dry-run æ¨¡å¼
        // æ³¨æ„ï¼šInstaller å¯¹è±¡åœ¨ä¸‹é¢çš„ script æ ‡ç­¾ä¸­åŠ è½½ï¼Œéœ€è¦å»¶è¿Ÿè®¾ç½®
      }

    } catch (e) {
      writeLog("Initialization error: " + e.message);
      alert('åˆå§‹åŒ–é”™è¯¯: ' + e.message + '\n\nè¯¦ç»†æ—¥å¿—å·²ä¿å­˜åˆ°:\n' + logFilePath);
    }

    // ç”¨é»˜è®¤æµè§ˆå™¨æ‰“å¼€ URL
    function openUrl(url) {
      try {
        shell.Run(url, 1);
      } catch (e) {
        alert('æ— æ³•æ‰“å¼€é“¾æ¥: ' + e.message);
      }
    }
  </script>

  <!-- å®‰è£…è¯´æ˜æ¨¡æ€çª—å£ -->
  <div id="installGuideModal" class="modal-overlay" onclick="handleModalOverlayClick(event, 'installGuideModal')">
    <div class="modal install-guide-modal">
      <div class="modal-header" id="installGuideTitle">å®‰è£…è¯´æ˜</div>
      <div class="modal-body" id="installGuideBody"></div>
      <div class="modal-footer">
        <button class="btn-got-it" onclick="closeInstallGuide()">çŸ¥é“äº†</button>
      </div>
    </div>
  </div>

  <!-- Red Panda ä½¿ç”¨è¯´æ˜æ¨¡æ€çª—å£ -->
  <div id="redPandaGuideModal" class="modal-overlay" onclick="handleModalOverlayClick(event, 'redPandaGuideModal')">
    <div class="modal guide-modal-common redpanda-guide-modal">
      <div class="modal-header">
        <span class="section-icon">ğŸ“š</span>
        Red Panda C++ EGE ä½¿ç”¨æŒ‡å—
      </div>
      <div class="modal-body">
        <div class="guide-section">
          <p style="font-size: 1.071rem; color: #1f2937; font-weight: 500; margin-bottom: 1.143rem;">
            æœ¬æŒ‡å—ä»‹ç»å¦‚ä½•åœ¨ Red Panda C++ ä¸­åˆ›å»ºå’Œä½¿ç”¨ EGE å›¾å½¢åº“é¡¹ç›®ã€‚
          </p>
          <p style="font-size: 0.929rem; color: #6b7280; margin-bottom: 1.143rem;">
            ğŸ’¡ <strong>æç¤ºï¼š</strong>Red Panda C++ å·²å†…ç½® EGE æ”¯æŒã€‚å¦‚éœ€ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ï¼Œè¯·å…ˆä½¿ç”¨å®‰è£…ç¨‹åºè¿›è¡Œæ›´æ–°ã€‚
          </p>
        </div>

        <div class="guide-section">
          <div class="info-box">
            <h3>âœ¨ Red Panda å·²å†…ç½® EGE</h3>
            <p>
              Red Panda C++ å·²ç»å†…ç½®äº† EGE å›¾å½¢åº“ï¼Œå¼€ç®±å³ç”¨ã€‚
            </p>
            <p>
              æœ¬å®‰è£…å™¨å°† EGE æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œè‡ªåŠ¨æ·»åŠ åˆ°ç¼–è¯‘å™¨çš„æ ‡å‡†æœç´¢è·¯å¾„ï¼Œä¼˜å…ˆäºå†…ç½®ç‰ˆæœ¬ã€‚
            </p>
          </div>
        </div>

        <div class="guide-section">
          <h3><span class="section-icon">ğŸ“</span>åˆ›å»º EGE é¡¹ç›®</h3>

          <p style="font-size: 0.929rem; color: #6b7280; margin-bottom: 0.571rem;"><strong>ä½¿ç”¨é¡¹ç›®æ¨¡æ¿ï¼ˆæ¨èï¼‰</strong></p>
          <p style="font-size: 0.929rem; margin-left: 1.429rem; color: #374151;">
            æ–‡ä»¶ â†’ æ–°å»º â†’ é¡¹ç›®... â†’ <strong>Multimedia</strong> â†’ <strong>EGE</strong>
          </p>

          <div style="margin: 0.857rem 0; text-align: center;">
            <img src="../assets/docs/images/redpanda_new_proj.png"
              style="max-width: 100%; height: auto; border: 1px solid #e5e7eb; border-radius: 0.429rem; box-shadow: 0 0.143rem 0.286rem rgba(0,0,0,0.1);"
              alt="Red Panda é¡¹ç›®æ¨¡æ¿" />
          </div>

          <p style="font-size: 0.929rem; color: #6b7280; margin: 0.857rem 0 0.571rem 0;"><strong>æ‰‹åŠ¨é…ç½®</strong></p>
          <p style="font-size: 0.929rem; margin-left: 1.429rem; color: #374151;">
            å¦‚éœ€æ‰‹åŠ¨é…ç½®ï¼Œåœ¨é¡¹ç›®å±æ€§ä¸­æ·»åŠ é“¾æ¥å™¨é€‰é¡¹ï¼ˆè¯¦è§å®˜æ–¹æ–‡æ¡£ï¼‰
          </p>
        </div>

        <div class="guide-section">
          <div class="guide-tips">
            <h3 style="margin: 0 0 0.571rem 0; font-size: 1.071rem; color: #92400e;">ğŸ’¡ å¿«é€Ÿæç¤º</h3>
            <ul>
              <li>æ¨¡æ¿å·²é…ç½®æ‰€æœ‰é€‰é¡¹ï¼Œ<strong>æ— éœ€æ‰‹åŠ¨è®¾ç½®</strong></li>
              <li>ç›´æ¥ä½¿ç”¨ <code>#include &lt;graphics.h&gt;</code></li>
              <li>æŒ‰ <strong>F11</strong> ç¼–è¯‘è¿è¡Œ</li>
              <li>å†…ç½® EGE ç‰ˆæœ¬ä¸å®˜æ–¹åŒæ­¥æ›´æ–°</li>
            </ul>
          </div>
        </div>

        <div class="guide-section"
          style="background: #fef3c7; border-left: 0.214rem solid #f59e0b; padding: 0.857rem; margin-top: 1.143rem;">
          <p style="margin: 0; font-size: 0.929rem; color: #78350f;">
            <span style="font-weight: 600;">ğŸ”„ ç‰ˆæœ¬æ›´æ–°æç¤º</span><br>
            åç»­ EGE ç‰ˆæœ¬æ›´æ–°æ—¶ï¼Œé‡æ–°è¿è¡Œæœ¬å®‰è£…å™¨å³å¯æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ã€‚
          </p>
        </div>

        <div class="guide-section">
          <h3><span class="section-icon">ğŸ“š</span>æ›´å¤šèµ„æº</h3>
          <p>
            <a href="javascript:void(0)" class="guide-link"
              onclick="openUrl('http://royqh.net/redpandacpp/'); return false;">Red Panda å®˜ç½‘</a> Â·
            <a href="javascript:void(0)" class="guide-link" onclick="openUrl('https://xege.org/'); return false;">EGE
              å®˜ç½‘</a> Â·
            <a href="javascript:void(0)" class="guide-link"
              onclick="openUrl('https://github.com/wysaid/xege'); return false;">GitHub æºç </a>
          </p>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-got-it" onclick="closeRedPandaGuide()">çŸ¥é“äº†ï¼Œå¼€å§‹ä½¿ç”¨ EGEï¼</button>
      </div>
    </div>
  </div>

  <!-- MSVC/Visual Studio ä½¿ç”¨è¯´æ˜æ¨¡æ€çª—å£ -->
  <div id="msvcGuideModal" class="modal-overlay" onclick="handleModalOverlayClick(event, 'msvcGuideModal')">
    <div class="modal large-guide-modal">
      <div class="modal-header">
        <span class="section-icon">ğŸ“š</span>
        Visual Studio EGE ä½¿ç”¨æŒ‡å—
      </div>
      <div class="modal-body">
        <div class="guide-section">
          <p style="font-size: 1.071rem; color: #1f2937; font-weight: 500; margin-bottom: 1.143rem;">
            æœ¬æŒ‡å—ä»‹ç»å¦‚ä½•åœ¨ Visual Studio ä¸­åˆ›å»ºå’Œä½¿ç”¨ EGE å›¾å½¢åº“é¡¹ç›®ã€‚
          </p>
          <p style="font-size: 0.929rem; color: #6b7280; margin-bottom: 1.143rem;">
            ğŸ’¡ <strong>æç¤ºï¼š</strong>å¦‚æœæ‚¨è¿˜æœªå®‰è£… EGEï¼Œè¯·å…ˆä½¿ç”¨å®‰è£…ç¨‹åºå°† EGE å®‰è£…åˆ° Visual Studioã€‚<br>
            âœ¨ <strong>ä¼˜åŠ¿ï¼š</strong>Visual Studio ä½¿ç”¨ EGE æ— éœ€æ‰‹åŠ¨é…ç½®é“¾æ¥å™¨é€‰é¡¹ï¼Œè‡ªåŠ¨é“¾æ¥æ‰€éœ€åº“æ–‡ä»¶ï¼
          </p>
        </div>

        <div class="guide-section">
          <h3><span class="section-icon">ğŸ“</span>åˆ›å»º EGE é¡¹ç›®</h3>

          <p style="font-size: 0.929rem; color: #6b7280; margin-bottom: 0.571rem;"><strong>Visual Studio 2019/2022/2026ï¼š</strong>
          </p>
          <p style="font-size: 0.929rem; margin-left: 1.429rem; color: #374151;">
            åˆ›å»ºæ–°é¡¹ç›® â†’ æœç´¢å¹¶é€‰æ‹© <strong>ç©ºé¡¹ç›®</strong> æˆ– <strong>æ§åˆ¶å°åº”ç”¨</strong>
          </p>

          <p style="font-size: 0.929rem; color: #6b7280; margin: 0.857rem 0 0.571rem 0;"><strong>Visual Studio 2017 åŠæ›´æ—©ç‰ˆæœ¬ï¼š</strong>
          </p>
          <p style="font-size: 0.929rem; margin-left: 1.429rem; color: #374151;">
            æ–‡ä»¶ â†’ æ–°å»º â†’ é¡¹ç›®... â†’ Visual C++ â†’ <strong>Win32 æ§åˆ¶å°åº”ç”¨ç¨‹åº</strong>
          </p>

          <p style="font-size: 0.929rem; color: #6b7280; margin: 0.857rem 0 0.571rem 0;"><strong>æ·»åŠ æºæ–‡ä»¶ï¼š</strong></p>
          <p style="font-size: 0.929rem; margin-left: 1.429rem; color: #374151;">
            è§£å†³æ–¹æ¡ˆèµ„æºç®¡ç†å™¨ â†’ å³é”® <strong>æºæ–‡ä»¶</strong> â†’ æ·»åŠ  â†’ æ–°å»ºé¡¹ â†’ <strong>C++ æ–‡ä»¶</strong>
          </p>
        </div>

        <div class="guide-section">
          <div class="guide-tips">
            <h3 style="margin: 0 0 0.571rem 0; font-size: 1.071rem; color: #92400e;">ğŸ’¡ å¿«é€Ÿæç¤º</h3>
            <ul>
              <li><strong>âœ¨ æ— éœ€é…ç½®é“¾æ¥å™¨ï¼</strong>VS è‡ªåŠ¨é“¾æ¥ EGE åº“æ–‡ä»¶</li>
              <li>ç›´æ¥ä½¿ç”¨ <code>#include &lt;graphics.h&gt;</code></li>
              <li>æŒ‰ <strong>Ctrl+F5</strong> ä¸è°ƒè¯•è¿è¡Œï¼ˆæ¨èï¼‰</li>
              <li>æ”¯æŒ <strong>x86</strong> å’Œ <strong>x64</strong> ä¸¤ç§æ¶æ„</li>
              <li>æ¨èåˆ›å»º <strong>ç©ºé¡¹ç›®</strong>ï¼Œæ— éœ€åˆ é™¤æ¨¡æ¿ä»£ç </li>
            </ul>
          </div>
        </div>

        <div class="guide-section">
          <div class="info-box">
            <h3>âœ¨ Visual Studio ä¼˜åŠ¿</h3>
            <p>
              EGE åº“ä½¿ç”¨äº† Visual Studio çš„<strong>è‡ªåŠ¨é“¾æ¥</strong>ç‰¹æ€§ï¼Œ
              ç¼–è¯‘æ—¶ä¼šè‡ªåŠ¨é“¾æ¥æ‰€éœ€çš„åº“æ–‡ä»¶ï¼ˆé€šè¿‡ <code>#pragma comment(lib, ...)</code> å®ç°ï¼‰ã€‚
            </p>
            <p style="margin-top: 0.571rem;">
              è¿™æ„å‘³ç€æ‚¨<strong>æ— éœ€æ‰‹åŠ¨æ·»åŠ ä»»ä½•é“¾æ¥å™¨é€‰é¡¹</strong>ï¼Œç›´æ¥ç¼–è¯‘å³å¯ä½¿ç”¨ï¼
            </p>
          </div>
        </div>

        <div class="guide-section"
          style="background: #f0f9ff; border-left: 0.214rem solid #3b82f6; padding: 0.857rem; margin-top: 1.143rem;">
          <p style="margin: 0; font-size: 0.929rem; color: #1e40af;">
            <span style="font-weight: 600;">ğŸ“– éœ€è¦è¯¦ç»†è¯´æ˜ï¼Ÿ</span><br>
            åŒ…å«å­—ç¬¦é›†é…ç½®ã€æ•…éšœæ’é™¤ã€ä»£ç ç¤ºä¾‹ã€å¸¸è§é—®é¢˜ç­‰å®Œæ•´æŒ‡å—
          </p>
          <button class="btn-view-docs" onclick="openMsvcFullDocs()"
            style="margin-top: 0.571rem; padding: 0.429rem 0.857rem; background: #3b82f6; color: white; border: none; border-radius: 0.286rem; cursor: pointer; font-size: 0.857rem;">
            æŸ¥çœ‹å®Œæ•´ä½¿ç”¨æ–‡æ¡£
          </button>
        </div>

        <div class="guide-section">
          <h3><span class="section-icon">ğŸ“š</span>æ›´å¤šèµ„æº</h3>
          <p>
            <a href="javascript:void(0)" class="guide-link"
              onclick="openUrl('https://xege.org/'); return false;">å®˜æ–¹ç½‘ç«™</a> Â·
            <a href="javascript:void(0)" class="guide-link"
              onclick="openUrl('https://github.com/wysaid/xege'); return false;">GitHub æºç </a>
          </p>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-got-it" onclick="closeMsvcGuide()">çŸ¥é“äº†ï¼Œå¼€å§‹ä½¿ç”¨ EGEï¼</button>
      </div>
    </div>
  </div>

  <!-- CLion æ’ä»¶æ¨èæ¨¡æ€çª—å£ -->
  <div id="clionPluginModal" class="modal-overlay" onclick="handleModalOverlayClick(event, 'clionPluginModal')">
    <div class="modal guide-modal-common clion-plugin-modal">
      <div class="modal-header">
        <span class="section-icon">ğŸ’¡</span>
        æ¨èä½¿ç”¨ CLion æ’ä»¶
      </div>
      <div class="modal-body">
        <div class="guide-section">
          <div class="info-box">
            <h3>ğŸ”Œ EGE å·²æä¾› JetBrains æ’ä»¶</h3>
            <p>
              xege å·²ç»åœ¨ JetBrains æ’ä»¶å•†åº—æä¾›äº† CLion ä¸“ç”¨æ’ä»¶ï¼Œ
              å¯ä»¥ç›´æ¥åœ¨ CLion ä¸­æœç´¢å®‰è£…ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®åº“æ–‡ä»¶è·¯å¾„ã€‚
            </p>
            <p>
              æ’ä»¶æä¾›ä¸€é”®æ–°å»º EGE é¡¹ç›®ã€è‡ªåŠ¨é…ç½® CMake ç­‰åŠŸèƒ½ï¼Œä½“éªŒæ›´ä½³ä¸”ä¾¿äºæ›´æ–°ã€‚
            </p>
          </div>
        </div>

        <div class="guide-section">
          <h3><span class="section-icon">ğŸ“¥</span>æ­¥éª¤ä¸€ï¼šå®‰è£…æ’ä»¶</h3>
          <p style="font-size: 0.929rem; color: #374151;">
            åœ¨ CLion ä¸­æ‰“å¼€ <strong>Settings â†’ Plugins â†’ Marketplace</strong>ï¼Œæœç´¢ <strong>"EGE"</strong> å³å¯å®‰è£…ã€‚
          </p>
          <div style="margin: 0.857rem 0; text-align: center;">
            <img src="../assets/docs/images/clion_plugin_install.png"
              style="max-width: 100%; height: auto; border: 1px solid #e5e7eb; border-radius: 0.429rem; box-shadow: 0 0.143rem 0.286rem rgba(0,0,0,0.1);"
              alt="CLion å®‰è£… EGE æ’ä»¶" />
          </div>
        </div>

        <div class="guide-section">
          <h3><span class="section-icon">ğŸ“</span>æ­¥éª¤äºŒï¼šæ–°å»º EGE é¡¹ç›®</h3>
          <p style="font-size: 0.929rem; color: #374151;">
            å®‰è£…æ’ä»¶åï¼Œé€šè¿‡ <strong>File â†’ New Project</strong> å³å¯ç›´æ¥åˆ›å»º EGE é¡¹ç›®ã€‚
          </p>
          <div style="margin: 0.857rem 0; text-align: center;">
            <img src="../assets/docs/images/clion_plugin_new_proj.png"
              style="max-width: 100%; height: auto; border: 1px solid #e5e7eb; border-radius: 0.429rem; box-shadow: 0 0.143rem 0.286rem rgba(0,0,0,0.1);"
              alt="CLion æ–°å»º EGE é¡¹ç›®" />
          </div>
        </div>

        <div class="guide-section">
          <div class="guide-tips">
            <h3 style="margin: 0 0 0.571rem 0; font-size: 1.071rem; color: #92400e;">ğŸ’¡ æç¤º</h3>
            <p style="font-size: 0.929rem; color: #78350f;">
              å¦‚æœæ‚¨ä»ç„¶å¸Œæœ›æ‰‹åŠ¨å°† EGE åº“æ–‡ä»¶å®‰è£…åˆ° CLion çš„ MinGW ç›®å½•ï¼Œ
              å¯ä»¥ç‚¹å‡»ä¸‹æ–¹ã€Œç»§ç»­å®‰è£…ã€æŒ‰é’®ã€‚ä½†æ¨èä½¿ç”¨æ’ä»¶æ–¹å¼ï¼Œä½“éªŒæ›´å¥½ã€‚
            </p>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-clion-plugin" onclick="openClionPluginPage()">å‰å¾€æ’ä»¶é¡µé¢</button>
        <button class="btn-clion-continue" onclick="confirmClionInstall()">ç»§ç»­å®‰è£…</button>
        <button class="btn-cancel" onclick="closeClionPluginModal()">å–æ¶ˆ</button>
      </div>
    </div>
  </div>

  <script language="JScript" src="detector.js"></script>
  <script language="JScript" src="installer.js"></script>
  <script language="JScript" src="ui.js"></script>
</body>

</html>